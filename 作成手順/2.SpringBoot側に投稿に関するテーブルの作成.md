# ğŸ“ Spring Bootã§Postsãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ‰±ã†ãŸã‚ã®å®Ÿè£…æ‰‹é †

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ä»¥ä¸‹ã®Postsãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã«åŸºã¥ã„ã¦ã€Spring Bootã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã® Entityãƒ»Repositoryãƒ»Controller ã‚’ä½œæˆã—ã¾ã™ã€‚

---

## ğŸ§¹ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤

Spring Boot ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ `DemoApplication.java` ã¯ä½¿ç”¨ã—ãªã„ãŸã‚ã€**å‰Šé™¤ã—ã¦æ§‹ã„ã¾ã›ã‚“**ã€‚  
ãŸã ã—ã€ä»£ã‚ã‚Šã«ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆç”¨ã®ã‚¯ãƒ©ã‚¹ï¼ˆä¾‹: `SimpleCrudSpringApplication.java`ï¼‰ã‚’åˆ¥é€”ä½œæˆã—ã¦ãã ã•ã„ï¼ˆå¿…è¦ã§ã‚ã‚Œã°ï¼‰ã€‚

---

## âœ… Postsãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ï¼ˆå‰æï¼‰

| ã‚«ãƒ©ãƒ å     | ãƒ‡ãƒ¼ã‚¿å‹           | å†…å®¹                       | åˆ¶é™ãƒ»ç‰¹å¾´                             |
|--------------|--------------------|----------------------------|----------------------------------------|
| `id`         | BIGINT (UNSIGNED)  | æŠ•ç¨¿IDï¼ˆè‡ªå‹•æ¡ç•ªï¼‰        | ä¸»ã‚­ãƒ¼                                 |
| `user_id`    | BIGINT (UNSIGNED)  | æŠ•ç¨¿è€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID        | å¤–éƒ¨ã‚­ãƒ¼ï¼ˆusers.id å‚ç…§ï¼‰ã€NULLä¸å¯     |
| `title`      | VARCHAR(255)       | æŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ«               | NULLä¸å¯                                |
| `content`    | TEXT               | æŠ•ç¨¿å†…å®¹ã®è©³ç´°             | NULLä¸å¯                                |
| `created_at` | TIMESTAMP          | ä½œæˆæ—¥æ™‚                   | è‡ªå‹•è¿½åŠ                                 |
| `updated_at` | TIMESTAMP          | æ›´æ–°æ—¥æ™‚                   | è‡ªå‹•è¿½åŠ                                 |
| `deleted_at` | TIMESTAMP          | å‰Šé™¤æ—¥æ™‚                   | è‡ªå‹•è¿½åŠ                                 |

---

## ğŸ“¦ 1. Entity ã®ä½œæˆï¼ˆ`Post.java`ï¼‰

```java
package com.example.simple_crud_spring.model;

import jakarta.persistence.*;

import java.time.LocalDateTime;

@Entity
@Table(name = "posts")
public class Post {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(name = "user_id", nullable = false)
    private Long userId;

    @Column(nullable = false, length = 255)
    private String title;

    @Column(nullable = false, columnDefinition = "TEXT")
    private String content;

    @Column(name = "created_at", updatable = false)
    private LocalDateTime createdAt;

    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Column(name = "deleted_at")
    private LocalDateTime deletedAt;

    @PrePersist
    protected void onCreate(){
        this.createdAt = LocalDateTime.now();
        this.updatedAt = LocalDateTime.now();
    }

    @PreUpdate
    protected void onUpdate(){ 
        this.updatedAt = LocalDateTime.now();
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Long getUserId() {
        return userId;
    }

    public void setUserId(Long userId) {
        this.userId = userId;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getContent() {
        return content;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public LocalDateTime getCreatedAt() {
        return createdAt;
    }

    public void setCreatedAt(LocalDateTime createdAt) {
        this.createdAt = createdAt;
    }

    public LocalDateTime getUpdatedAt() {
        return updatedAt;
    }

    public void setUpdatedAt(LocalDateTime updatedAt) {
        this.updatedAt = updatedAt;
    }

    public LocalDateTime getDeletedAt() {
        return deletedAt;
    }

    public void setDeletedAt(LocalDateTime deletedAt) {
        this.deletedAt = deletedAt;
    }

    
}
```

---

## ğŸ“š 2. Repository ã®ä½œæˆï¼ˆ`PostRepository.java`ï¼‰

```java
package com.example.simple_crud_spring.repository;

import com.example.simple_crud_spring.model.Post;
import org.springframework.data.jpa.repository.JpaRepository;

public interface PostRepository extends JpaRepository<Post, Long>{
    // è¿½åŠ ã®ã‚¯ã‚¨ãƒªãƒ¡ã‚½ãƒƒãƒ‰ã¯å¿…è¦ã«å¿œã˜ã¦
}

```

---

## ğŸŒ 3. Controller ã®ä½œæˆï¼ˆ`PostController.java`ï¼‰

```java
package com.example.simple_crud_spring.controller;

import com.example.simple_crud_spring.model.Post;
import com.example.simple_crud_spring.repository.PostRepository;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@CrossOrigin(origins = "*")
@RestController
@RequestMapping("/api/posts")
public class PostController{
    
    private final PostRepository postRepository;

    public PostController(PostRepository postRepository){
        this.postRepository = postRepository;
    }

    @GetMapping
    public List<Post> getAll(){
        return postRepository.findAll();
    }

    @PostMapping
    public Post create(@RequestBody Post post){
        return postRepository.save(post);
    }

    @GetMapping("/{id}")
    public Post getById(@PathVariable Long id){
        return postRepository.findById(id).orElse(null);
    }

    @PutMapping("/{id}")
    public Post update(@PathVariable Long id, @RequestBody Post updatedPost){
        return postRepository.findById(id)
            .map(post -> {
                post.setTitle(updatedPost.getTitle());
                post.setContent(updatedPost.getContent());
                post.setUserId(updatedPost.getUserId());
                return postRepository.save(post);
            })
            .orElse(null);
    }
}
```

## ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

- gradlew.bat bootRunã‚’ä¸­æ–­ã—ã€å†åº¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚
- â€»ã‚«ãƒ©ãƒ åãªã©ã‚’é–“é•ãˆãŸãªã©ã®ç†ç”±ã‹ã‚‰å¤‰æ›´ã—ãŸã„å ´åˆã€ä¸€åº¦ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’A5M2ä¸Šã§ãƒ‰ãƒ­ãƒƒãƒ—ã—ã€å†åº¦gradlew.bat bootRunã‚’ä¸­æ–­ã—ã€å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚
- A5M2ä¸Šã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚«ãƒ©ãƒ åãŒå¤‰ã‚ã‚‰ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€A5M2ã‚’å†èµ·å‹•ã™ã‚‹ã¨å¤‰æ›´å¾Œã®è¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚
- 

---

## âœ… å®Œäº†å¾Œã«ç¢ºèªã§ãã‚‹ã“ã¨

- `/api/posts` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€GETãƒ»POSTãƒ»PUTãƒ»DELETE ã®APIãŒä½¿ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
- Reactã‹ã‚‰ `fetch("http://localhost:8080/api/posts")` ã§å‘¼ã³å‡ºã™ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿é€£æºãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

---

## ğŸ€ è£œè¶³

- `@PrePersist` ãŠã‚ˆã³ `@PreUpdate` ã«ã‚ˆã‚Šã€`created_at` ã¨ `updated_at` ã‚’è‡ªå‹•è¨­å®šã—ã¾ã™ã€‚
- `deleted_at` ã¯ç¾æ™‚ç‚¹ã§æœªä½¿ç”¨ï¼ˆè«–ç†å‰Šé™¤æœªå®Ÿè£…ï¼‰ã§ã™ãŒã€å¿…è¦ã«å¿œã˜ã¦ `@SQLDelete` ãªã©ã‚’å°å…¥ã—ã¦ãã ã•ã„ã€‚
